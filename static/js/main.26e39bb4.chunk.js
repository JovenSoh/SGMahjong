(this.webpackJsonpsgmahjong=this.webpackJsonpsgmahjong||[]).push([[0],{127:function(e,n,t){},128:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t(41),a=t.n(c),i=t(15),o=t(6),s=t(32),l=t.n(s),u=t(10),d=t(73),b=t(7),j=t(63),f=t(53),h=t(50);function O(e,n){if(e.suit<n.suit)return-1;if(e.suit>n.suit)return 1;if(e.suit===n.suit){if(e.value<n.value)return-1;if(e.value>n.value)return 1}return 0}function g(e){var n,t=[],r=new Map,c=Object(h.a)(e);try{for(c.s();!(n=c.n()).done;){var a=n.value;r.has(a.value)||(r.set(a.value,!0),t.push({suit:a.suit,value:a.value,id:a.id,picture:a.picture}))}}catch(i){c.e(i)}finally{c.f()}return t}function p(e,n,t){if(console.log("Recursion",e,n,t),n.length>5)return[!1,n,t];if(n.length>0&&n.forEach((function(n){n.forEach((function(n){e=e.filter((function(e){return!(e.picture===n.picture&&e.id===n.id)}))}))})),e.length>0){var r=g(e.filter((function(n){return n.suit===e[0].suit&&(n.value===e[0].value||n.value===e[0].value+1||n.value===e[0].value+2)}))),c=e.filter((function(n){return n.picture===e[0].picture}));return 3==r.length&&(console.log("Sequential set",r),p(e,n.concat([r]),t)[0])?p(e,n.concat([r]),t):4==c.length&&(console.log("Kong set",c),p(e,n.concat([c]),t)[0])||3==c.length&&(console.log("Pong set",c),p(e,n.concat([c]),t)[0])?p(e,n.concat([c]),t):2==c.length&&!t&&(console.log("Eye",c),p(e,n.concat([c]),!0)[0])?p(e,n.concat([c]),!0):[!1,n,t]}return 0===e.length?[!0,n,t]:void 0}function x(e){var n=e.reduce((function(e,n){return e["".concat(n.suit," ").concat(n.value)]=++e["".concat(n.suit," ").concat(n.value)]||0,e}),{}),t=e.filter((function(e){return 1===n["".concat(e.suit," ").concat(e.value)]}));if(console.log("Pairs: ",t),14===t.length)return[!0,[],[],[],"\u4e03\u5bf9\u5b50"];var r=e.filter((function(e){return"bamboo"===e.suit&&1===e.value||"bamboo"===e.suit&&9===e.value||"circles"===e.suit&&1===e.value||"circles"===e.suit&&9===e.value||"numbers"===e.suit&&1===e.value||"numbers"===e.suit&&9===e.value||"~north"===e.suit||"~south"===e.suit||"~east"===e.suit||"~west"===e.suit||"~red"===e.suit||"~green"===e.suit||"~white"===e.suit}));console.log("\u5341\u4e09\u5e7a: ",r);var c=Object(f.a)(new Map(r.map((function(e){return[JSON.stringify([e.suit,e.value]),e]}))).values());if(14===r.length&&13===c.length)return[!0,[],[],[],"\u5341\u4e09\u5e7a"];var a=p(e,[],!1),i=Object(o.a)(a,2),s=i[0],l=i[1];if(s){var u;console.log("Winning hand!",l);var d=[],b=[];return l.forEach((function(e){e.filter((function(n){return n.picture=e[0].picture})).length>1?2==e.length?u=e:d.concat(e):b.concat(e)})),[!0,b,d,u,null]}return[!1,[],[],[],""]}function m(e,n,t,r,c,a,s){var l,u,d=e.concat(n.concat(a).concat(s)).sort(O),b=e.concat(n.concat(a).concat(s)).sort(O),h=[{name:"allPong",value:!1,points:2},{name:"\u81ed\u5e73\u548c",value:!1,points:1},{name:"\u5e73\u548c",value:!1,points:4},{name:"\u6e05\u4e00\u8272",value:!1,points:4},{name:"\u6df7\u4e00\u8272",value:!1,points:2},{name:"oneNine",value:!1,points:5},{name:"halfOneNine",value:!1,points:1},{name:"\u4e03\u5bf9\u5b50",value:!1,points:3},{name:"\u5341\u4e09\u5e7a",value:!1,points:5}],g=x(d),p=Object(o.a)(g,5),m=p[0],v=p[1],w=p[2],S=p[3],y=p[4];if(y)"\u4e03\u5bf9\u5b50"===y?h[h.findIndex((function(e){return"\u4e03\u5bf9\u5b50"===e.name}))].value=!0:"\u5341\u4e09\u5e7a"===y&&(h[h.findIndex((function(e){return"\u5341\u4e09\u5e7a"===e.name}))].value=!0);else if(m){if(w.length>=12&&(h[h.findIndex((function(e){return"allPong"===e.name}))].value=!0),"~red"!=S[0].suit&&"~green"!=S[0].suit&&"~white"!=S[0].suit&&S[0].suit!=r&&S[0].suit!=c&&4===v.length)if(0!==a.length){var T=v.filter((function(e){return e.indexOf(a)>0}));T[0]!==a&&T[2]!==a||(0===t.length?h[h.findIndex((function(e){return"\u5e73\u548c"===e.name}))].value=!0:h[h.findIndex((function(e){return"\u81ed\u5e73\u548c"===e.name}))].value=!0)}else 0===t.length?h[h.findIndex((function(e){return"\u5e73\u548c"===e.name}))].value=!0:h[h.findIndex((function(e){return"\u81ed\u5e73\u548c"===e.name}))].value=!0;var P=Object(f.a)(new Set(b.map((function(e){return e.suit})))),C=["~east","~south","~west","~north","~red","~green","~white"];console.log("Suits: ",P),console.log("Filtered suits:",P.filter((function(e){return!C.includes(e)}))),1===P.length?h[h.findIndex((function(e){return"\u6e05\u4e00\u8272"===e.name}))].value=!0:1===P.filter((function(e){return!C.includes(e)})).length&&(h[h.findIndex((function(e){return"\u6df7\u4e00\u8272"===e.name}))].value=!0);var I=Object(f.a)(new Set(b.map((function(e){return e.value}))));console.log("oneNine: ",I.filter((function(e){return 9!==e&&1!==e&&null!==e}))),0===I.filter((function(e){return 9!==e&&1!==e})).length?h[h.findIndex((function(e){return"oneNine"===e.name}))].value=!0:0===I.filter((function(e){return 9!==e&&1!==e&&null!==e})).length&&(h[h.findIndex((function(e){return"halfOneNine"===e.name}))].value=!0);var N,k=["cat","mouse","rooster","centipede"],D=t.filter((function(e){return k.includes(e.suit)})).length;console.log("Animals: ",D);var R=["~east","~south","~west","~north"],E=t.filter((function(e){return!k.includes(e.suit)&&R[e.value-1]===c})).length;console.log("Winds: ",E);var A=["~red","~green","~white"],W=Math.floor(w.filter((function(e){return A.includes(e.suit)})).length/3);console.log("Dragon Tiles: ",W);var F=Math.floor(w.filter((function(e){return e.suit===r})).length/3);console.log("Table Wind: ",F);var J=Math.floor(w.filter((function(e){return e.suit===c})).length/3);function e(e,n){return e+n}console.log("Your Wind: ",J);var M=h.filter((function(e){return!0===e.value})).map((function(e){return e.points})).reduce(e,0);console.log("Combi points: ",M),N=W+F+J+M+D+E>5?5:W+F+J+M+D+E,console.log("Total points: ",N),u=h.filter((function(e){return!0===e.value})).map((function(e){return Object(i.a)({},e.name,e.points)})),l=Object(j.a)(Object(j.a)({},u[0]),{},{animalPoints:D,windPoints:E,dragonPoints:W,tableWindPoints:F,yourWindPoints:J,totalPoints:N,selfDrawn:0===a.length})}return[m,l]}var v=t(71),w=t(3);function S(e){var n=e.picture,t=e.color,r=e.hoveredTile;if(!t);return r?n===r.picture?Object(w.jsx)(v.a,{src:"./images/"+n+".jpg",fallbackSrc:"../images/"+n+".jpg",h:"6vh",borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px ".concat(t)}):Object(w.jsx)(v.a,{src:"./images/"+n+".jpg",fallbackSrc:"../images/"+n+".jpg",opacity:"30%",h:"6vh",borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"300px 400px 100px ".concat(t)}):Object(w.jsx)(v.a,{src:"./images/"+n+".jpg",fallbackSrc:"../images/"+n+".jpg",h:"6vh",borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px ".concat(t)})}function y(e){var n=e.tiles,t=e.direction,r=e.hoveredTile;if("vertical"===t){var c=0;return n.length>10&&(c=.14*n.length),Object(w.jsx)(d.h,{spacing:"-".concat(c,"vh"),children:n.map((function(e){return Object(w.jsx)(S,{picture:e.picture,hoveredTile:r})}))})}return Object(w.jsx)(d.d,{spacing:"1px",children:n.map((function(e){return Object(w.jsx)(S,{picture:e.picture,hoveredTile:r})}))})}function T(e){var n=e.playerID,t=e.username,r=e.currentPlayer,c=e.wind;return Object(w.jsx)(d.b,{children:Object(w.jsxs)(d.c,{h:"3vh",textColor:"#fafafa",overflow:"hidden",bgColor:r===n?"#a36453":"#55342b",px:"5px",borderRadius:"10px",borderWidth:"1px",borderColor:"black",borderStyle:"solid",children:[t,Object(w.jsx)(v.a,{p:"2px",borderRadius:"5px",src:c?"/images/".concat(c,".jpg"):null,fallbackSrc:c?"../images/".concat(c,".jpg"):null,w:"2.3vh",h:"2.8vh"})]})})}function P(e){var n=e.gameState,t=e.gameStateIndex,r=e.currentPlayer,c=e.playerIndex,a=e.hoveredTile,i=function(e){return Array.apply(null,Array(n[e].handLength)).map((function(){})).map((function(){return Object(w.jsx)(d.a,{h:"3.5vh",w:"2vh",borderRadius:"5px",borderWidth:"1px",borderColor:"black",bg:"white",borderStyle:"solid"})}))};return 1===c?Object(w.jsx)(d.a,{children:n[(t+1)%4]&&Object(w.jsxs)(d.h,{spacing:"10px",children:[Object(w.jsx)(T,{playerID:n[(t+1)%4].playerID,username:n[(t+1)%4].username,currentPlayer:r,wind:n[(t+1)%4].wind}),Object(w.jsxs)(d.d,{children:[Object(w.jsx)(d.a,{w:"60px",children:Object(w.jsx)(y,{direction:"vertical",tiles:n[(t+1)%4].revealedTiles.concat(n[(t+1)%4].bonusTiles),hoveredTile:a})}),Object(w.jsx)(d.a,{children:Object(w.jsx)(d.h,{spacing:"2px",children:i((t+1)%4)})})]})]})}):2===c?Object(w.jsx)(d.a,{children:n[(t+2)%4]&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(T,{playerID:n[(t+2)%4].playerID,username:n[(t+2)%4].username,currentPlayer:r,wind:n[(t+2)%4].wind}),Object(w.jsxs)(d.a,{children:[Object(w.jsx)(d.b,{children:Object(w.jsx)(d.d,{spacing:"2px",children:function(e){return Array.apply(null,Array(n[e].handLength)).map((function(){})).map((function(){return Object(w.jsx)(d.a,{h:"2vh",w:"3.5vh",borderRadius:"5px",borderWidth:"1px",borderColor:"black",bg:"white",borderStyle:"solid"})}))}((t+2)%4)})}),Object(w.jsx)(d.b,{children:Object(w.jsx)(y,{tiles:n[(t+2)%4].revealedTiles.concat(n[(t+2)%4].bonusTiles),hoveredTile:a})})]})]})}):3===c?Object(w.jsx)(d.a,{children:n[(t+3)%4]&&Object(w.jsxs)(d.h,{spacing:"10px",children:[Object(w.jsx)(T,{playerID:n[(t+3)%4].playerID,username:n[(t+3)%4].username,currentPlayer:r,wind:n[(t+3)%4].wind}),Object(w.jsxs)(d.d,{children:[Object(w.jsx)(d.a,{children:Object(w.jsx)(d.h,{spacing:"2px",children:i((t+3)%4)})}),Object(w.jsx)(d.a,{w:"60px",children:Object(w.jsx)(y,{direction:"vertical",tiles:n[(t+3)%4].revealedTiles.concat(n[(t+3)%4].bonusTiles),hoveredTile:a})})]})]})}):void 0}var C=t(43);function I(e){var n=e.discards,t=e.hoveredTile,r=e.setHoveredTile,c=e.handleHover,a=n.map((function(e){return Object(w.jsx)(C.a.div,{onHoverStart:function(){return c(e)},onHoverEnd:function(){return r(null)},whileHover:{scale:1.1},children:Object(w.jsx)(S,{picture:e.picture,hoveredTile:t})})}));return Object(w.jsx)(d.i,{spacing:"5px",h:"50vh",w:"50vh",children:a})}function N(e){var n,t,c=Object(r.useRef)(null);return n=c,t=e.handleSelectTile,Object(r.useEffect)((function(){function e(e){n.current&&!n.current.contains(e.target)&&t(null)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[n]),Object(w.jsx)("div",{ref:c,children:e.children})}var k=t(74);function D(e){var n=e.lastDiscard,t=e.sequentialTiles,r=e.pongTiles,c=e.kongTiles,a=e.game,o=e.handleChow,s=e.handlePong,l=e.handleKong,u=e.handleGame,b=t.map((function(e){return Object(w.jsx)(d.a,{p:"5px",bg:"#55342b",_hover:{bg:"#a36453"},borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px #000000",onClick:function(){console.log("Selected chow set",e),o(e.concat(n).sort(O))},children:Object(w.jsx)(y,{tiles:e.concat(n).sort(O)})})})),j=r.map((function(e){return Object(w.jsx)(d.a,{p:"5px",bg:"#55342b",_hover:{bg:"#a36453"},borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px #000000",onClick:function(){console.log("Selected pong set",e),s(e.sort(O))},children:Object(w.jsx)(y,{tiles:e.sort(O)})})})),f=c.map((function(e){if(e.length>1){var n=e[4];return e=e.slice(0,4),Object(w.jsx)(d.a,{p:"5px",bg:"#55342b",_hover:{bg:"#a36453"},borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px #000000",onClick:function(){console.log("Selected kong set",e),l(e.sort(O),n)},children:Object(w.jsx)(y,{tiles:e.sort(O)})})}}));return Object(w.jsxs)(d.d,{h:"100px",children:[t.length>0?b:null,r.length>0?j:null,c.length>0?f:null,a?function(){var e;return Object(w.jsx)(k.a,(e={p:"5px",variant:"ghost",_hover:{bg:"rgba(255,255,255,0.2)"},bg:"rgba(255,255,255,0.1)",borderRadius:"10px"},Object(i.a)(e,"p","5px"),Object(i.a)(e,"onClick",u),Object(i.a)(e,"display",a?"block":"none"),Object(i.a)(e,"children","Game"),e))}():null]})}function R(e){var n=e.clientID,t=e.tiles,c=e.newTile,a=e.handleSelectTile,i=e.currentTurn,s=e.currentPlayer,l=e.gameState,u=e.discards,b=e.selectedTile,j=e.handleDiscard,f=e.lastDiscard,h=e.pongTiles,O=e.handlePong,g=e.sequentialTiles,p=e.handleChow,x=e.kongTiles,m=e.handleKong,v=e.game,T=e.handleGame,k=Object(r.useState)(),R=Object(o.a)(k,2),E=R[0],A=R[1],W=l.findIndex((function(e){return e.playerID===n})),F={selected:{y:-15},unselected:{y:0}},J=function(e){A(e)},M=t.map((function(e,n){var t="#343434";return e===c&&i&&(t="#ff4a4a"),Object(w.jsx)(C.a.div,{onHoverStart:function(){return J(e)},onHoverEnd:function(){return A(null)},whileHover:{scale:1.1},variants:F,animate:b===e?"selected":"unselected",children:Object(w.jsx)(d.a,{value:e,onClick:function(){return function(e){b===e&&i?j():a(e)}(e)},children:Object(w.jsx)(S,{picture:e.picture,color:t})},n)})}));return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(d.h,{h:"95vh",w:"95vh",m:"auto",mt:"2vh",bgColor:"#006442",borderWidth:"5px",borderColor:"#55342b",borderStyle:"solid",children:[l[(W+2)%4]?Object(w.jsx)(P,{gameState:l,gameStateIndex:W,currentPlayer:s,playerIndex:2,hoveredTile:E}):Object(w.jsx)(d.f,{}),Object(w.jsx)(d.f,{}),Object(w.jsxs)(d.d,{w:"100%",children:[l[(W+3)%4]?Object(w.jsx)(P,{gameState:l,gameStateIndex:W,currentPlayer:s,playerIndex:3,hoveredTile:E}):Object(w.jsx)(d.f,{}),Object(w.jsx)(d.f,{}),Object(w.jsx)(I,{discards:u,hoveredTile:E,setHoveredTile:A,handleHover:J}),Object(w.jsx)(d.f,{}),l[(W+1)%4]?Object(w.jsx)(P,{gameState:l,gameStateIndex:W,currentPlayer:s,playerIndex:1,hoveredTile:E}):Object(w.jsx)(d.f,{})]}),Object(w.jsx)(d.f,{}),0===g.length&&0===h.length&&x.reduce((function(e,n){return e+n.length}),0)<=1&&!v?Object(w.jsx)(d.a,{h:"100px"}):Object(w.jsx)(D,{lastDiscard:f,sequentialTiles:g,pongTiles:h,kongTiles:x,game:v,handleChow:p,handlePong:O,handleKong:m,handleGame:T}),l[W]&&Object(w.jsxs)(d.a,{position:"relative",zIndex:2,children:[Object(w.jsx)(d.a,{w:"100%",m:"auto",children:Object(w.jsx)(d.b,{mb:"5px",children:Object(w.jsx)(y,{tiles:l[W].revealedTiles.concat(l[W].bonusTiles)})})}),Object(w.jsx)(d.b,{w:"100%",m:"auto",mb:"5px",children:Object(w.jsx)(N,{handleSelectTile:a,children:Object(w.jsx)(d.d,{spacing:"1px",children:M})})})]})]})})}var E=t(75),A=t(77);function W(e){var n=e.username,t=e.roundEnd,c=e.summary,a=e.handleNewGame,i=e.draw,s=e.isOpen,l=e.onOpen,u=e.onClose,b=Object(r.useState)(!0),j=Object(o.a)(b,2),f=j[0],h=j[1];Object(r.useEffect)((function(){t&&(l(),setTimeout((function(){h(!1)}),3e3))}),[t]);var O={animalPoints:"Animal Tiles",dragonPoints:"Dragon Set",windPoints:"Seat Flower",tableWindPoints:"Prevailing Wind Set",yourWindPoints:"Seat Wind Set",totalPoints:"Total tai",allPong:"All Pong","\u81ed\u5e73\u548c":"All Chow","\u5e73\u548c":"Ping Wu","\u6e05\u4e00\u8272":"Full Color","\u6df7\u4e00\u8272":"Half Color",oneNine:"All Terminals",halfOneNine:"Terminals and Honors","\u4e03\u5bf9\u5b50":"7 Pairs","\u5341\u4e09\u5e7a":"13 Wonders"};if(t){var g=[];c=Object.keys(c).forEach((function(e){c[e]>0&&(g=g.concat({name:O[e],points:c[e]}))}));var p=g.map((function(e){return Object(w.jsxs)(E.f,{children:[Object(w.jsx)(E.c,{children:e.name}),Object(w.jsx)(E.c,{isNumeric:!0,children:e.points})]})}));return console.log("Summary filtered",g),i?Object(w.jsxs)(A.a,{isOpen:s,onClose:u,children:[Object(w.jsx)(A.g,{}),Object(w.jsxs)(A.d,{children:[Object(w.jsx)(A.f,{children:"Draw"}),Object(w.jsx)(A.c,{}),Object(w.jsx)(A.e,{children:Object(w.jsx)(k.a,{isDisabled:f,onClick:a,children:"New game"})})]})]}):Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(A.a,{isOpen:s,onClose:u,children:[Object(w.jsx)(A.g,{}),Object(w.jsxs)(A.d,{children:[Object(w.jsx)(A.f,{h:"10px",children:Object(w.jsxs)(d.b,{children:[n.username," wins!"]})}),Object(w.jsx)(A.c,{}),Object(w.jsx)(A.b,{children:Object(w.jsxs)(E.a,{variant:"striped",size:"sm",children:[Object(w.jsx)(E.e,{children:Object(w.jsxs)(E.f,{children:[Object(w.jsx)(E.d,{children:"Name"}),Object(w.jsx)(E.d,{isNumeric:!0,children:"Double"})]})}),Object(w.jsx)(E.b,{children:p})]})}),Object(w.jsx)(A.e,{children:Object(w.jsx)(k.a,{size:"sm",isDisabled:f,onClick:a,children:"New game"})})]})]})})}return null}var F=t(78),J=t(76),M=t(65),G=t(29);function H(e){var n=e.name,t=e.score,r=e.info,c=e.pictures,a=Object(u.e)(),i=a.isOpen,o=a.onToggle,s=c.map((function(e){return""===e?Object(w.jsx)(d.a,{w:"10px"}):Object(w.jsx)(v.a,{src:"/images/"+e+".jpg",fallbackSrc:"",h:"26px",borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"1.2px 2px #000000"})}));return Object(w.jsxs)(d.a,{children:[Object(w.jsxs)(d.c,{children:[Object(w.jsx)(d.a,{_hover:{"text-decoration":"underline"},onClick:o,children:n}),Object(w.jsx)(d.f,{}),t]}),Object(w.jsxs)(G.a,{in:i,children:[r.split(".").map((function(e){return Object(w.jsx)(d.g,{align:"left",justifyContent:!0,fontSize:12,children:e})})),Object(w.jsx)(d.d,{spacing:"0px",children:s})]})]})}function L(e){var n,t=e.tableWind,r=e.yourWind,c=e.playerID,a=e.currentPlayer,i=e.gameState,o=e.handleNewGame,s=e.roundEnd,l=e.onOpen,b=(e.summary,Object(u.c)(window.location.href.split("/").at(-1))),j=b.hasCopied,f=b.onCopy,h=i.map((function(e){return Object(w.jsxs)(d.c,{w:"100%",children:[e.username,Object(w.jsx)(d.f,{}),e.score]})})),O={"~east":1,"~south":2,"~west":3,"~north":4},g=[{name:"Prevailing wind set",score:1,info:"Pong or kong of prevailing wind",pictures:t?[t,t,t]:["~east","~east","~east"]},{name:"Seat wind set",score:1,info:"Pong or kong of seat wind",pictures:r?[r,r,r]:["~east","~east","~east"]},{name:"Dragon tiles set",score:1,info:"Pong or kong of any dragon tiles",pictures:["~red","~red","~red"]},{name:"All Chow",score:1,info:"Four sets of sequentials with an eye. Eye must not be prevailing or seat wind or dragon tile. Unless self-drawn, must have a two-sided wait",pictures:["bamboo1","bamboo2","bamboo3","circles1","circles2","circles3","numbers5","numbers5"]},{name:"Seat flower",score:1,info:"Flower corresponding to your seat position",pictures:r?["flowers"+O[r],"flowers"+(O[r]+4)]:["flowers1","flowers5"]},{name:"Animal tile",score:1,info:"Any animal tile",pictures:["cat","mouse","rooster","centipede"]},{name:"All Pong",score:2,info:"Four sets of pong or kong with an eye",pictures:["bamboo2","bamboo2","bamboo2","numbers6","numbers6","numbers6","~white","~white"]},{name:"Mixed suit",score:2,info:"Mahjong with one suit and honors",pictures:["~east","~east","~east","bamboo9","bamboo9","bamboo9","~red","~red"]},{name:"Terminals and Honors",score:2,info:"Mahjong with 1s, 9s, and honors",pictures:["circles1","circles1","circles1","numbers9","numbers9","numbers9","~north","~north"]},{name:"7 Pairs",score:3,info:"7 eyes",pictures:["~east","~east","~west","~west","~green","~green","circles5","circles5"]},{name:"Ping Wu",score:4,info:"All chow without flower or animal tiles",pictures:["bamboo4","bamboo5","bamboo6","circles4","circles5","circles6","numbers7","numbers7"]},{name:"Full Color",score:4,info:"Mahjong with only one suit",pictures:["numbers1","numbers2","numbers3","numbers8","numbers8","numbers8","numbers9","numbers9"]},{name:"13 Wonders",score:5,info:"Each terminal and honors. Any eye",pictures:["bamboo1","bamboo9","~east","~south","~west","~north","~red","~red"]},{name:"All Terminals",score:5,info:"Mahjong with only 1s and 9s",pictures:["numbers1","numbers1","numbers1","circles1","circles1","circles1","bamboo9","bamboo9"]}].map((function(e){return Object(w.jsx)(H,{name:e.name,score:e.score,info:e.info,pictures:e.pictures})})),p=[{name:"Predator Prey",score:1,info:"Cat-mouse rooster-centipede pair",pictures:["cat","mouse","","rooster","centipede"]},{name:"Flower Pair",score:1,info:"Own an opponent flower pair",pictures:["flowers"+(O[r]+1)%8,"flowers"+(O[r]+5)%8]},{name:"Concealed Kong",score:2,info:"Perform a one/three tiles concealed kong",pictures:["bamboo8","bamboo8","bamboo8","bamboo8"]},{name:"Flowers Set (u/c)",score:4,info:"Own all red or black flowers",pictures:["flowers1","flowers2","flowers3","flowers4","flowers5","flowers6","flowers7","flowers8"]},{name:"Animals Set (u/c)",score:4,info:"Own all animal tiles",pictures:["cat","mouse","rooster","centipede"]}].map((function(e){return Object(w.jsx)(H,{name:e.name,score:e.score,info:e.info,pictures:e.pictures})}));return i.find((function(e){return e.playerID===c}))&&(n=i.find((function(e){return e.playerID===c})).username,console.log("USERNAME: ",n)),Object(w.jsxs)(F.e,{mr:"10px",align:"center",variant:"enclosed",isFitted:!0,children:[Object(w.jsxs)(F.b,{children:[Object(w.jsx)(F.a,{children:"Table"}),Object(w.jsx)(F.a,{children:"Scoring"})]}),Object(w.jsxs)(F.d,{children:[Object(w.jsx)(F.c,{w:"200px",children:Object(w.jsxs)(d.h,{spacing:"25px",children:[Object(w.jsxs)(d.a,{mt:"5px",children:[Object(w.jsx)(T,{playerID:c,username:n,currentPlayer:a,wind:r}),Object(w.jsxs)(d.c,{w:"190px",children:["Prevailing Wind ",Object(w.jsx)(d.f,{})," ",Object(w.jsx)(v.a,{src:"/images/"+t+".jpg",fallbackSrc:"/images/blank.jpg",h:"30px",borderRadius:"5px"})," "]})]}),Object(w.jsxs)(d.a,{children:[Object(w.jsx)(d.e,{fontSize:20,mb:"5px",children:"Leaderboard"}),Object(w.jsx)(d.a,{w:"190px",children:h})]}),Object(w.jsx)(d.c,{children:Object(w.jsxs)(k.b,{isAttached:!0,size:"sm",variant:"outline",children:[Object(w.jsx)(k.a,{disabled:!s,onClick:l,children:"Summary"}),Object(w.jsx)(k.a,{disabled:!s,onClick:o,children:"New game"})]})}),Object(w.jsxs)(d.a,{children:[Object(w.jsx)(d.g,{textAlign:"left",p:"0px",m:"0px",children:"Invite code"}),Object(w.jsxs)(J.b,{children:[Object(w.jsx)(J.a,{h:"30px",px:"2px",variant:"filled",value:j?"Copied!":window.location.href.split("/").at(-1),isReadOnly:!0}),Object(w.jsx)(J.c,{h:"30px",children:Object(w.jsxs)(k.a,{h:"30px",onClick:f,variant:"outline",children:[" ",j?Object(w.jsx)(M.a,{h:"20px"}):Object(w.jsx)(M.b,{h:"20px"})," "]})})]})]})]})}),Object(w.jsxs)(F.c,{w:"200px",children:[Object(w.jsxs)(d.c,{w:"100%",children:[Object(w.jsx)("strong",{children:"Name"}),Object(w.jsx)(d.f,{}),Object(w.jsx)("strong",{children:"Double"})]}),g,Object(w.jsxs)(d.c,{w:"100%",mt:"10px",children:[Object(w.jsx)("strong",{children:"Instant Payout"}),Object(w.jsx)(d.f,{}),Object(w.jsx)("strong",{children:"Points"})]}),p]})]})]})}var U=t(48);function K(e){var n=e.sendMessage,t=Object(u.e)({defaultIsOpen:!0}),c=t.isOpen,a=(t.onOpen,t.onClose),i=Object(r.useState)(""),s=Object(o.a)(i,2),l=s[0],b=s[1],j=function(){a(),n("Username: "+l)};return Object(w.jsxs)(A.a,{isOpen:c,onClose:a,closeOnOverlayClick:!1,children:[Object(w.jsx)(A.g,{}),Object(w.jsxs)(A.d,{children:[Object(w.jsx)(A.f,{children:"Username"}),Object(w.jsxs)(U.a,{px:"20px",children:[Object(w.jsx)(J.a,{onKeyPress:function(e){"Enter"===e.key?j():console.log()},onChange:function(e){b(e.target.value)},value:l,placeholder:"Username"}),Object(w.jsxs)(d.c,{children:[Object(w.jsx)(d.f,{}),Object(w.jsx)(k.a,{my:"10px",onClick:j,type:"submit",children:"Submit"})]})]})]})]})}function z(){var e,n,t,c,a=Object(b.g)().gameId,j=Object(r.useState)("wss://mahjong.irscybersec.tk/api/".concat(a)),f=Object(o.a)(j,2),h=f[0],p=(f[1],Object(r.useState)([])),x=Object(o.a)(p,2),v=(x[0],x[1]),S=Object(r.useState)([]),y=Object(o.a)(S,2),T=(y[0],y[1]),P=Object(r.useState)([]),C=Object(o.a)(P,2),I=C[0],N=C[1],k=Object(r.useState)(),D=Object(o.a)(k,2),E=D[0],A=D[1],F=Object(r.useState)(),J=Object(o.a)(F,2),M=J[0],G=J[1],H=Object(r.useState)(null),U=Object(o.a)(H,2),z=U[0],q=U[1],_=Object(r.useState)([]),Y=Object(o.a)(_,2),B=Y[0],V=Y[1],Q=Object(r.useState)(),X=Object(o.a)(Q,2),Z=X[0],$=X[1],ee=Object(r.useState)([]),ne=Object(o.a)(ee,2),te=ne[0],re=ne[1],ce=Object(r.useState)([]),ae=Object(o.a)(ce,2),ie=ae[0],oe=ae[1],se=Object(r.useState)(""),le=Object(o.a)(se,2),ue=le[0],de=le[1],be=Object(r.useState)(""),je=Object(o.a)(be,2),fe=je[0],he=je[1],Oe=Object(r.useState)([]),ge=Object(o.a)(Oe,2),pe=ge[0],xe=ge[1],me=Object(r.useState)(),ve=Object(o.a)(me,2),we=ve[0],Se=ve[1],ye=Object(r.useState)([]),Te=Object(o.a)(ye,2),Pe=Te[0],Ce=Te[1],Ie=Object(r.useState)([]),Ne=Object(o.a)(Ie,2),ke=Ne[0],De=Ne[1],Re=Object(r.useState)([]),Ee=Object(o.a)(Re,2),Ae=Ee[0],We=Ee[1],Fe=Object(r.useState)(!1),Je=Object(o.a)(Fe,2),Me=Je[0],Ge=Je[1],He=Object(r.useState)(),Le=Object(o.a)(He,2),Ue=Le[0],Ke=Le[1],ze=Object(r.useState)(!1),qe=Object(o.a)(ze,2),_e=qe[0],Ye=qe[1],Be=Object(u.e)(),Ve=Be.isOpen,Qe=Be.onOpen,Xe=Be.onClose,Ze=Object(r.useState)(!1),$e=Object(o.a)(Ze,2),en=$e[0],nn=$e[1],tn=Object(r.useState)(!1),rn=Object(o.a)(tn,2),cn=rn[0],an=rn[1],on=Object(r.useState)(1),sn=Object(o.a)(on,2),ln=sn[0],un=(sn[1],Object(r.useState)(3e3)),dn=Object(o.a)(un,2),bn=dn[0],jn=(dn[1],Object(r.useState)([])),fn=Object(o.a)(jn,2),hn=fn[0],On=fn[1],gn=Object(r.useState)(null),pn=Object(o.a)(gn,2),xn=pn[0],mn=pn[1],vn=B.reduce((function(e,n){return e["".concat(n.suit," ").concat(n.value)]=++e["".concat(n.suit," ").concat(n.value)]||0,e}),{}),wn=function(){yn("New game!")},Sn=l()(h),yn=Sn.sendMessage,Tn=Sn.lastMessage,Pn=Sn.readyState,Cn=(e={},Object(i.a)(e,s.ReadyState.CONNECTING,"Connecting"),Object(i.a)(e,s.ReadyState.OPEN,"Connected"),Object(i.a)(e,s.ReadyState.CLOSING,"Closing"),Object(i.a)(e,s.ReadyState.CLOSED,"Disconnected"),Object(i.a)(e,s.ReadyState.UNINSTANTIATED,"Uninstantiated"),e)[Pn];return Object(r.useEffect)((function(){if(null!==Tn)if(console.log("Last message: ",Tn.data),v((function(e){return e.concat(Tn)})),Tn.data.includes("Online users:")){var e=Tn.data.replace("Online users: ","");T(e)}else if(Tn.data.includes("Game state")){var r=Tn.data.replace("Game state: ","");console.log("Game state: ",r),On(JSON.parse(r))}else if(Tn.data.includes("Your ID")){var a=Tn.data.replace("Your ID: ","");N(a)}else if(Tn.data.includes("Tiles")){var i=JSON.parse(Tn.data.replace("Tiles: ",""));if(13===i.length?V(i.sort(O)):V((function(e){return e.concat(i).sort(O)})),$(i),console.log("New tiles:",i),13!==i.length){console.log("Tiles:",B);var s=m(B,ie,te,fe,ue,[],i),l=Object(o.a)(s,2),u=l[0],d=l[1];!function(e){var n=B.filter((function(n){return n.suit===e.suit&&n.value===e.value})).concat(e),t=B.filter((function(e){return 3==vn["".concat(e.suit," ").concat(e.value)]}));4==n.length?(We([n.concat("four")]),console.log("Four concealed kong",n)):t&&(We([t.concat("four")]),console.log("kongSets",t));var r=hn.findIndex((function(e){return e.playerID===I})),c=hn[r].revealedTiles.filter((function(n){return n.suit===e.suit&&n.value===e.value})).concat(e);4==c.length&&(We([c.concat("four")]),console.log("One concealed kong",c))}(i),Ge(u),Ke(d)}}else if(Tn.data.includes("Bonus")){var b=JSON.parse(Tn.data.replace("Bonus: ",""));2===(p=b).filter((function(e){return"cat"===e.suit||"mouse"===e.suit})).length?(console.log("CAT MOUSE PAIR"),yn("AnimalPair")):2===p.filter((function(e){return"rooster"===e.suit||"centipede"===e.suit})).length&&(console.log("ROOSTER CENTIPEDE PAIR"),yn("AnimalPair")),2===p.filter((function(e){return 1===e.value})).length?(console.log("FlowerPair 1"),yn("FlowerPair ~east")):2===p.filter((function(e){return 2===e.value})).length?(console.log("2 FLOWER PAIR"),yn("FlowerPair ~south")):2===p.filter((function(e){return 3===e.value})).length?(console.log("3 FLOWER PAIR"),yn("FlowerPair ~west")):2===p.filter((function(e){return 4===e.value})).length&&(console.log("4 FLOWER PAIR"),yn("FlowerPair ~north")),p.forEach((function(e){"mouse"===e.suit&&te.filter((function(e){return"cat"===e.suit})).length>0||"cat"===e.suit&&te.filter((function(e){return"mouse"===e.suit})).length>0?(console.log("CAT MOUSE PAIR"),yn("AnimalPair")):("rooster"===e.suit&&te.filter((function(e){return"centipede"===e.suit})).length>0||"centipede"===e.suit&&te.filter((function(e){return"rooster"===e.suit})).length>0)&&(console.log("ROOSTER CENTIPEDE PAIR"),yn("AnimalPair")),1===te.filter((function(n){return n.value===e.value})).length&&console.log("".concat(e.value," FLOWER PAIR"))})),re((function(e){return e.concat(b)}))}else if(Tn.data.includes("Table wind"))he(Tn.data.replace("Table wind: ",""));else if(Tn.data.includes("Your wind"))de(Tn.data.replace("Your wind: ",""));else if(Tn.data.includes("It is your turn"))Ye(!0);else if(Tn.data.includes("Discards")){var j=JSON.parse(Tn.data.replace("Discards: ",""));xe(j),Se(j.at(-1)),console.log("Last discarded",j.at(-1)),function(e){if(e&&I!==z){var r=m(B,ie,te,fe,ue,e,[]),a=Object(o.a)(r,2),i=a[0],s=a[1];Ke(s),console.log("Summary: ",s),i&&s.totalpoints>=ln&&(Ge(i),setTimeout((function(){Ge(!1)}),bn));var l=B.filter((function(n){return n.suit===e.suit&&n.value===e.value})).concat(e);if(console.log("Same tiles: ",l),3==l.length?(De([l]),setTimeout((function(){De([])}),bn)):4==l.length&&(We([l.concat("three")]),setTimeout((function(){We([])}),bn)),hn.at(hn.findIndex((function(e){return e.playerID===I}))-1).playerID===z){n=B.filter((function(n){return n.suit===e.suit&&(n.value===e.value-1||n.value===e.value-2)})),t=B.filter((function(n){return n.suit===e.suit&&(n.value===e.value-1||n.value===e.value+1)})),c=B.filter((function(n){return n.suit===e.suit&&(n.value===e.value+1||n.value===e.value+2)})),n=g(n),t=g(t),c=g(c);var u=[n,t,c].filter((function(e){return 2===e.length}));u.length>0&&(Ce(u),setTimeout((function(){Ce([])}),bn))}}}(j.at(-1))}else if(Tn.data.includes("Previous player: "))q(Tn.data.replace("Previous player: ",""));else if(Tn.data.includes("Revealed"))!function(){var e=JSON.parse(Tn.data.replace("Revealed: ","")),n=B;console.log("New Tiles: ",n);for(var t=function(t){console.log("Target: ",e[t]),console.log("Target Index: ",n.indexOf(e[t])),n=n.filter((function(n){return!(n.suit===e[t].suit&&n.value===e[t].value&&n.id===e[t].id)}))},r=0;r<e.length;r++)t(r);V(n),oe((function(n){return n.concat(e).sort(O)}))}();else if(Tn.data.includes("Current player: ")){var f=Tn.data.replace("Current player: ","");G(f.substring(1,f.length-1))}else if(Tn.data.includes("New game!"))an(!1),nn(!1),xe([]),Se(),re([]),oe([]),mn();else if(Tn.data.includes("wins")){yn("ShowAll: "+JSON.stringify(B)),V([]),an(!0);var h=JSON.parse(Tn.data.split(" ")[2]);Ke(h),A(Tn.data.split(" ")[0])}else Tn.data.includes("Draw:")&&(nn(!0),an(!0),yn("ShowAll: "+JSON.stringify(B)),V([]));var p}),[Tn,v]),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(K,{sendMessage:yn}),Object(w.jsxs)(d.c,{children:[Object(w.jsx)(R,{clientID:I,tiles:B,newTile:Z,handleSelectTile:function(e){console.log(e),mn(e)},currentTurn:_e,currentPlayer:M,gameState:hn,discards:pe,selectedTile:xn,handleDiscard:function(){if(!cn){Ge(!1),console.log("Discarding ",xn),yn("Discard: "+JSON.stringify(xn));var e=B.filter((function(e){return!(e.suit===xn.suit&&e.value===xn.value&&e.id===xn.id)}));V(e),mn(null),We([]),Ye(!1)}},lastDiscard:we,pongTiles:ke,handlePong:function(e){console.log("PONG!",ke),De([]),yn(I+" pong "+JSON.stringify(e))},handleChow:function(e){console.log("CHOW!",Pe),Ce([]),yn(I+" chow "+JSON.stringify(e))},sequentialTiles:Pe,kongTiles:Ae,handleKong:function(e,n){console.log("KONG!",e,n),We([]),"three"===n?yn(I+" threekong "+JSON.stringify(e)):"four"===n?yn(I+" fourkong "+JSON.stringify(e)):"one"===n&&yn(I+" onekong "+JSON.stringify(e))},game:Me,handleGame:function(){yn(I+" WINS! "+JSON.stringify(Ue)+" "+JSON.stringify(B)),Ge(!1),V([])}}),Object(w.jsx)(L,{tableWind:fe,yourWind:ue,playerID:I,currentPlayer:M,gameState:hn,handleNewGame:wn,roundEnd:cn,onOpen:Qe,summary:Ue})]}),Object(w.jsxs)(d.a,{children:[Object(w.jsx)(W,{username:hn.find((function(e){return e.playerID===E})),roundEnd:cn,summary:Ue,handleNewGame:wn,draw:en,isOpen:Ve,onOpen:Qe,onClose:Xe}),Object(w.jsxs)("p",{children:["Connection Status: ",Cn]})]})]})}var q=t.p+"static/media/mahjongVid.74b8b9da.webm";t(127);function _(){var e=Object(b.f)(),n=Object(r.useState)(""),t=Object(o.a)(n,2),c=t[0],a=t[1],i=Object(r.useState)("100%"),s=Object(o.a)(i,2),l=s[0],j=s[1],f=Object(u.e)(),h=f.isOpen,O=f.onToggle;return Object(w.jsxs)(d.b,{h:"100vh",w:"100vw",bg:"rgba(90,90,90,0.3)",children:[Object(w.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,id:"video",children:Object(w.jsx)("source",{src:q,type:"video/webm"})}),Object(w.jsxs)(d.a,{w:"300px",p:"10px",bgColor:"rgba(240,240,240,0.9)",borderRadius:"10px",children:[Object(w.jsx)(d.b,{children:Object(w.jsxs)(d.g,{fontSize:"24px",textAlign:"center",children:["Play ",Object(w.jsx)("strong",{children:"Singapore Mahjong"})," with your friends"]})}),Object(w.jsx)(k.a,{onClick:function(){e("/game/".concat(function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()}()))},w:"100%",variant:"outline",borderWidth:"1px",borderStyle:"solid",borderColor:"green",borderRadius:"10px",children:"Create game"}),Object(w.jsxs)(d.c,{children:[Object(w.jsx)(G.a,{mt:"7px",in:h,direction:"left",animateOpacity:!0,children:Object(w.jsx)(J.a,{px:"2px",focusBorderColor:"green",variant:"flushed",placeholder:"Invite code",value:c,onChange:function(e){return function(e){a(e.target.value)}(e)}})}),Object(w.jsxs)(k.a,{onClick:h?function(){c.length<10?alert("No room found"):e("/game/".concat(c))}:function(){j("35%"),O()},w:l,variant:"outline",_focus:{outline:"none"},borderWidth:"1px",borderStyle:"solid",borderColor:"green",borderRadius:"10px",children:[h?"Join":"Join game"," "]})]})]})]})}var Y=t(49);function B(){return Object(w.jsx)(Y.a,{forceRefresh:!0,basename:"/sgmahjong/",children:Object(w.jsxs)(b.c,{children:[Object(w.jsx)(b.a,{path:"/",exact:!0,element:Object(w.jsx)(_,{})}),Object(w.jsx)(b.a,{path:"/game/:gameId",exact:!0,element:Object(w.jsx)(z,{})})]})})}var V=t(14);a.a.render(Object(w.jsx)(V.a,{children:Object(w.jsx)(B,{})}),document.getElementById("root"))}},[[128,1,2]]]);
//# sourceMappingURL=main.26e39bb4.chunk.js.map