(this.webpackJsonpsgmahjong=this.webpackJsonpsgmahjong||[]).push([[0],{127:function(e,n,t){},128:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t(42),i=t.n(o),c=t(23),a=t(6),s=t(32),l=t.n(s),u=t(10),d=t(73),b=t(29),j=t(74),h=t(38),f=t(7),g=t(64),O=t(54),p=t(51);function x(e,n){if(e.suit<n.suit)return-1;if(e.suit>n.suit)return 1;if(e.suit===n.suit){if(e.value<n.value)return-1;if(e.value>n.value)return 1}return 0}function m(e){var n,t=[],r=new Map,o=Object(p.a)(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;r.has(i.value)||(r.set(i.value,!0),t.push({suit:i.suit,value:i.value,id:i.id,picture:i.picture}))}}catch(c){o.e(c)}finally{o.f()}return t}function v(e,n,t){if(console.log("Recursion",e,n,t),n.length>5)return[!1,n,t];if(n.length>0&&n.forEach((function(n){n.forEach((function(n){e=e.filter((function(e){return!(e.picture===n.picture&&e.id===n.id)}))}))})),e.length>0){var r=m(e.filter((function(n){return n.suit===e[0].suit&&(n.value===e[0].value||n.value===e[0].value+1||n.value===e[0].value+2)}))),o=e.filter((function(n){return n.picture===e[0].picture}));return 3==r.length&&(console.log("Sequential set",r),v(e,n.concat([r]),t)[0])?v(e,n.concat([r]),t):4==o.length&&(console.log("Kong set",o),v(e,n.concat([o]),t)[0])||3==o.length&&(console.log("Pong set",o),v(e,n.concat([o]),t)[0])?v(e,n.concat([o]),t):2==o.length&&!t&&(console.log("Eye",o),v(e,n.concat([o]),!0)[0])?v(e,n.concat([o]),!0):[!1,n,t]}return 0===e.length?[!0,n,t]:void 0}function w(e,n,t,r,o,i,s){var l,u,d=e.concat(n.concat(i).concat(s)).sort(x),b=[{name:"allPong",value:!1,points:2},{name:"\u81ed\u5e73\u548c",value:!1,points:1},{name:"\u5e73\u548c",value:!1,points:4},{name:"\u6e05\u4e00\u8272",value:!1,points:4},{name:"\u6df7\u4e00\u8272",value:!1,points:2},{name:"oneNine",value:!1,points:5},{name:"halfOneNine",value:!1,points:1},{name:"\u4e03\u5bf9\u5b50",value:!1,points:3},{name:"\u5341\u4e09\u5e7a",value:!1,points:5}],j=function(e,n){var t=e.concat(n),r=t.reduce((function(e,n){return e["".concat(n.suit," ").concat(n.value)]=++e["".concat(n.suit," ").concat(n.value)]||0,e}),{}),o=t.filter((function(e){return 1===r["".concat(e.suit," ").concat(e.value)]}));if(console.log("Pairs: ",o),14===o.length)return[!0,[],[],[],"\u4e03\u5bf9\u5b50"];var i=t.filter((function(e){return"bamboo"===e.suit&&1===e.value||"bamboo"===e.suit&&9===e.value||"circles"===e.suit&&1===e.value||"circles"===e.suit&&9===e.value||"numbers"===e.suit&&1===e.value||"numbers"===e.suit&&9===e.value||"~north"===e.suit||"~south"===e.suit||"~east"===e.suit||"~west"===e.suit||"~red"===e.suit||"~green"===e.suit||"~white"===e.suit}));console.log("\u5341\u4e09\u5e7a: ",i);var c=Object(O.a)(new Map(i.map((function(e){return[JSON.stringify([e.suit,e.value]),e]}))).values());if(14===i.length&&13===c.length)return[!0,[],[],[],"\u5341\u4e09\u5e7a"];var s=v(e,[],!1),l=Object(a.a)(s,2),u=l[0],d=l[1],b=v(n,[],!1),j=Object(a.a)(b,2);if(j[0],d=j[1].concat(d),u){var h;console.log("Winning hand!",d);var f=[],g=[];return d.forEach((function(e){var n=e.filter((function(n){return n.picture===e[0].picture}));console.log("Set temp",n),n.length>1?2==e.length?h=e:f=f.concat([e]):g=g.concat([e])})),[!0,g,f,h,null]}return[!1,[],[],[],""]}(e.concat(i).concat(s).sort(x),n),h=Object(a.a)(j,5),f=h[0],p=h[1],m=h[2],w=h[3],S=h[4];if(console.log("Pong Sets:",m),console.log("Chow sets:",p),console.log("Eye:",w),S)"\u4e03\u5bf9\u5b50"===S?b[b.findIndex((function(e){return"\u4e03\u5bf9\u5b50"===e.name}))].value=!0:"\u5341\u4e09\u5e7a"===S&&(b[b.findIndex((function(e){return"\u5341\u4e09\u5e7a"===e.name}))].value=!0);else if(f){if(m.length>=4&&(b[b.findIndex((function(e){return"allPong"===e.name}))].value=!0),"~red"!=w[0].suit&&"~green"!=w[0].suit&&"~white"!=w[0].suit&&w[0].suit!=r&&w[0].suit!=o&&4===p.length)if(0!==i.length){var y=p.filter((function(e){return e.indexOf(i)>0}));y[0]!==i&&y[2]!==i||(0===t.length?b[b.findIndex((function(e){return"\u5e73\u548c"===e.name}))].value=!0:b[b.findIndex((function(e){return"\u81ed\u5e73\u548c"===e.name}))].value=!0)}else 0===t.length?b[b.findIndex((function(e){return"\u5e73\u548c"===e.name}))].value=!0:b[b.findIndex((function(e){return"\u81ed\u5e73\u548c"===e.name}))].value=!0;var P=Object(O.a)(new Set(d.map((function(e){return e.suit})))),C=["~east","~south","~west","~north","~red","~green","~white"];console.log("Suits: ",P),console.log("Filtered suits:",P.filter((function(e){return!C.includes(e)}))),1===P.length?b[b.findIndex((function(e){return"\u6e05\u4e00\u8272"===e.name}))].value=!0:1===P.filter((function(e){return!C.includes(e)})).length&&(b[b.findIndex((function(e){return"\u6df7\u4e00\u8272"===e.name}))].value=!0);var T=Object(O.a)(new Set(d.map((function(e){return e.value}))));console.log("oneNine: ",T.filter((function(e){return 9!==e&&1!==e&&null!==e}))),0===T.filter((function(e){return 9!==e&&1!==e})).length?b[b.findIndex((function(e){return"oneNine"===e.name}))].value=!0:0===T.filter((function(e){return 9!==e&&1!==e&&null!==e})).length&&(b[b.findIndex((function(e){return"halfOneNine"===e.name}))].value=!0);var I,k=0,N=0,D=0,E=["cat","mouse","rooster","centipede"],R=t.filter((function(e){return E.includes(e.suit)})).length;console.log("Animals: ",R);var A=["~east","~south","~west","~north"],W=t.filter((function(e){return!E.includes(e.suit)&&A[e.value-1]===o})).length;console.log("Flowers: ",W);var J=["~red","~green","~white"];function e(e,n){return e+n}m.forEach((function(e){console.log("PongSets: ",e),k+=Math.floor(e.filter((function(e){return J.includes(e.suit)})).length/3),N+=Math.floor(e.filter((function(e){return e.suit===r})).length/3),D+=Math.floor(e.filter((function(e){return e.suit===o})).length/3)})),console.log("Dragon Tiles: ",k),console.log("Table Wind: ",N),console.log("Your Wind: ",D);var M=b.filter((function(e){return!0===e.value})).map((function(e){return e.points})).reduce(e,0);console.log("Combi points: ",M),I=k+N+D+M+R+W>5?5:k+N+D+M+R+W,console.log("Total points: ",I),u=b.filter((function(e){return!0===e.value})).map((function(e){return Object(c.a)({},e.name,e.points)})),l=Object(g.a)(Object(g.a)({},u[0]),{},{animalPoints:R,flowerPoints:W,dragonPoints:k,tableWindPoints:N,yourWindPoints:D,totalPoints:I,selfDrawn:0===i.length})}return[f,l]}var S=t(71),y=t(3);function P(e){var n,t=e.picture,r=e.color,o=e.hoveredTile;return n=r||"#343434",o?t===o.picture?Object(y.jsx)(S.a,{src:"https://raw.githubusercontent.com/JovenSoh/sgmahjong/gh-pages/images/".concat(t,".jpg"),fallbackSrc:"../images/"+t+".jpg",h:window.innerHeight>window.innerWidth?"8vw":"6vh",borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px ".concat(n)}):Object(y.jsx)(S.a,{src:"https://raw.githubusercontent.com/JovenSoh/sgmahjong/gh-pages/images/".concat(t,".jpg"),fallbackSrc:"../images/"+t+".jpg",h:window.innerHeight>window.innerWidth?"8vw":"6vh",borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px ".concat(n),opacity:"30%"}):Object(y.jsx)(S.a,{src:"https://raw.githubusercontent.com/JovenSoh/sgmahjong/gh-pages/images/".concat(t,".jpg"),fallbackSrc:"../images/"+t+".jpg",h:window.innerHeight>window.innerWidth?"8vw":"6vh",borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px ".concat(n)})}function C(e){var n=e.tiles,t=e.direction,r=e.hoveredTile;if("vertical"===t){var o=0;return n.length>10&&(o=.14*n.length),Object(y.jsx)(d.h,{spacing:"-".concat(o,"vh"),children:n.map((function(e){return Object(y.jsx)(P,{picture:e.picture,hoveredTile:r})}))})}return Object(y.jsx)(d.d,{spacing:"1px",children:n.map((function(e){if(e)return Object(y.jsx)(P,{picture:e.picture,hoveredTile:r})}))})}function T(e){var n=e.playerID,t=e.username,r=e.currentPlayer,o=e.wind,i={"~east":"}wind1","~south":"}wind2","~west":"}wind3","~north":"}wind4"}[o];return Object(y.jsx)(d.b,{children:Object(y.jsxs)(d.c,{h:"3vh",textColor:"#fafafa",overflow:"hidden",bgColor:r===n?"#a36453":"#55342b",px:"5px",borderRadius:"10px",borderWidth:"1px",borderColor:"black",borderStyle:"solid",children:[t,Object(y.jsx)(S.a,{p:"2px",borderRadius:"5px",src:i?"https://raw.githubusercontent.com/JovenSoh/sgmahjong/gh-pages/images/".concat(i,".jpg"):null,fallbackSrc:o?"../images/".concat(i,".jpg"):null,w:"2.3vh",h:"2.8vh"})]})})}function I(e){var n=e.gameState,t=e.gameStateIndex,r=e.currentPlayer,o=e.playerIndex,i=e.hoveredTile,c=function(e){return Array.apply(null,Array(n[e].handLength)).map((function(){})).map((function(){return Object(y.jsx)(d.a,{h:"3.5vh",w:"2vh",borderRadius:"5px",borderWidth:"1px",borderColor:"black",bg:"white",borderStyle:"solid"})}))};return 1===o?Object(y.jsx)(d.a,{children:n[(t+1)%4]&&Object(y.jsxs)(d.h,{spacing:"10px",children:[Object(y.jsx)(T,{playerID:n[(t+1)%4].playerID,username:n[(t+1)%4].username,currentPlayer:r,wind:n[(t+1)%4].wind}),Object(y.jsxs)(d.d,{children:[Object(y.jsx)(d.a,{w:"60px",children:Object(y.jsx)(C,{direction:"vertical",tiles:n[(t+1)%4].revealedTiles.concat(n[(t+1)%4].bonusTiles),hoveredTile:i})}),Object(y.jsx)(d.a,{children:Object(y.jsx)(d.h,{spacing:"2px",children:c((t+1)%4)})})]})]})}):2===o?Object(y.jsx)(d.a,{children:n[(t+2)%4]&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(T,{playerID:n[(t+2)%4].playerID,username:n[(t+2)%4].username,currentPlayer:r,wind:n[(t+2)%4].wind}),Object(y.jsxs)(d.a,{children:[Object(y.jsx)(d.b,{children:Object(y.jsx)(d.d,{spacing:"2px",children:function(e){return Array.apply(null,Array(n[e].handLength)).map((function(){})).map((function(){return Object(y.jsx)(d.a,{h:"2vh",w:"3.5vh",borderRadius:"5px",borderWidth:"1px",borderColor:"black",bg:"white",borderStyle:"solid"})}))}((t+2)%4)})}),Object(y.jsx)(d.b,{children:Object(y.jsx)(C,{tiles:n[(t+2)%4].revealedTiles.concat(n[(t+2)%4].bonusTiles),hoveredTile:i})})]})]})}):3===o?Object(y.jsx)(d.a,{children:n[(t+3)%4]&&Object(y.jsxs)(d.h,{spacing:"10px",children:[Object(y.jsx)(T,{playerID:n[(t+3)%4].playerID,username:n[(t+3)%4].username,currentPlayer:r,wind:n[(t+3)%4].wind}),Object(y.jsxs)(d.d,{children:[Object(y.jsx)(d.a,{children:Object(y.jsx)(d.h,{spacing:"2px",children:c((t+3)%4)})}),Object(y.jsx)(d.a,{w:"60px",children:Object(y.jsx)(C,{direction:"vertical",tiles:n[(t+3)%4].revealedTiles.concat(n[(t+3)%4].bonusTiles),hoveredTile:i})})]})]})}):void 0}var k=t(44);function N(e){var n=e.discards,t=e.hoveredTile,r=e.setHoveredTile,o=e.handleHover,i=n.map((function(e){return Object(y.jsx)(k.a.div,{onHoverStart:function(){return o(e)},onHoverEnd:function(){return r(null)},whileHover:{scale:1.1},children:Object(y.jsx)(P,{picture:e.picture,hoveredTile:t})})}));return Object(y.jsx)(d.i,{spacing:"5px",h:"50vh",w:"50vh",overflowY:"auto",overflowX:"hidden",children:i})}function D(e){var n,t,o=Object(r.useRef)(null);return n=o,t=e.handleSelectTile,Object(r.useEffect)((function(){function e(e){n.current&&!n.current.contains(e.target)&&t(null)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[n]),Object(y.jsx)("div",{ref:o,children:e.children})}function E(e){var n=e.lastDiscard,t=e.sequentialTiles,r=e.pongTiles,o=e.kongTiles,i=e.game,c=e.handleChow,a=e.handlePong,s=e.handleKong,l=e.handleGame,u=e.validMove,b=e.handleSkip,h=t.map((function(e){return Object(y.jsx)(d.a,{p:"5px",bg:"#55342b",_hover:{bg:"#a36453"},borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px #000000",onClick:function(){console.log("Selected chow set",e),c(e.concat(n).sort(x))},children:Object(y.jsx)(C,{tiles:e.concat(n).sort(x)})})})),f=r.map((function(e){return Object(y.jsx)(d.a,{p:"5px",bg:"#55342b",_hover:{bg:"#a36453"},borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px #000000",onClick:function(){console.log("Selected pong set",e),a(e.sort(x))},children:Object(y.jsx)(C,{tiles:e.sort(x)})})})),g=o.map((function(e){if(e.length>1){var n=e[4];return e=e.slice(0,4),Object(y.jsx)(d.a,{p:"5px",bg:"#55342b",_hover:{bg:"#a36453"},borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"3px 4px #000000",onClick:function(){console.log("Selected kong set",e),s(e.sort(x),n)},children:Object(y.jsx)(C,{tiles:e.sort(x)})})}}));return Object(y.jsxs)(d.d,{h:"100px",children:[u?Object(y.jsx)(j.a,{w:"100px",h:"50px",textColor:"white",p:"0",fontSize:"18",variant:"ghost",bg:"#55342b",_hover:{bg:"#a36453"},onClick:b,display:u?"block":"none",children:"Skip"}):null,t.length>0&&u?h:null,r.length>0&&u?f:null,o.length>0?g:null,i&&u?Object(y.jsx)(j.a,{w:"100px",h:"50px",textColor:"white",p:"0",fontSize:"18",variant:"ghost",bg:"#55342b",_hover:{bg:"#a36453"},onClick:l,display:i?"block":"none",children:"Mahjong"}):null]})}function R(e){var n=e.clientID,t=e.tiles,o=e.newTile,i=e.handleSelectTile,c=e.currentTurn,s=e.currentPlayer,l=e.gameState,u=e.discards,b=e.selectedTile,j=e.handleDiscard,h=e.lastDiscard,f=e.pongTiles,g=e.handlePong,O=e.sequentialTiles,p=e.handleChow,x=e.kongTiles,m=e.handleKong,v=e.game,w=e.handleGame,S=e.validMove,T=(e.setValidMove,e.handleSkip),R=Object(r.useState)(),A=Object(a.a)(R,2),W=A[0],J=A[1],M=l.findIndex((function(e){return e.playerID===n})),F={selected:{y:-15},unselected:{y:0}},H=function(e){J(e)},z=t.map((function(e,n){var t="#343434";return e===o&&c&&(t="#ff4a4a"),Object(y.jsx)(k.a.div,{onHoverStart:function(){return H(e)},onHoverEnd:function(){return J(null)},whileHover:{scale:1.1},variants:F,animate:b===e?"selected":"unselected",children:Object(y.jsx)(d.a,{value:e,onClick:function(){return function(e){b===e&&c?j():i(e)}(e)},children:Object(y.jsx)(P,{picture:e.picture,color:t})},n)})}));return Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(d.h,{h:"95vh",w:window.innerHeight>window.innerWidth?"95vw":"95vh",m:"auto",mt:"2vh",bgColor:"#006442",borderWidth:"5px",borderColor:"#55342b",borderStyle:"solid",children:[l[(M+2)%4]?Object(y.jsx)(I,{gameState:l,gameStateIndex:M,currentPlayer:s,playerIndex:2,hoveredTile:W}):Object(y.jsx)(d.f,{}),Object(y.jsx)(d.f,{}),Object(y.jsxs)(d.d,{w:"100%",children:[l[(M+3)%4]?Object(y.jsx)(I,{gameState:l,gameStateIndex:M,currentPlayer:s,playerIndex:3,hoveredTile:W}):Object(y.jsx)(d.f,{}),Object(y.jsx)(d.f,{}),Object(y.jsx)(N,{discards:u,hoveredTile:W,setHoveredTile:J,handleHover:H}),Object(y.jsx)(d.f,{}),l[(M+1)%4]?Object(y.jsx)(I,{gameState:l,gameStateIndex:M,currentPlayer:s,playerIndex:1,hoveredTile:W}):Object(y.jsx)(d.f,{})]}),Object(y.jsx)(d.f,{}),0===O.length&&0===f.length&&x.reduce((function(e,n){return e+n.length}),0)<=1&&!v&&!S?Object(y.jsx)(d.a,{h:"100px"}):Object(y.jsx)(E,{lastDiscard:h,sequentialTiles:O,pongTiles:f,kongTiles:x,game:v,handleChow:p,handlePong:g,handleKong:m,handleGame:w,validMove:S,handleSkip:T}),l[M]&&Object(y.jsxs)(d.a,{position:"relative",zIndex:2,children:[Object(y.jsx)(d.a,{w:"100%",m:"auto",children:Object(y.jsx)(d.b,{mb:"5px",children:Object(y.jsx)(C,{tiles:l[M].revealedTiles.concat(l[M].bonusTiles)})})}),Object(y.jsx)(d.b,{w:"100%",m:"auto",mb:"5px",children:Object(y.jsx)(D,{handleSelectTile:i,children:Object(y.jsx)(d.d,{spacing:"1px",children:z})})})]})]})})}var A=t(75),W=t(77);function J(e){var n=e.username,t=e.roundEnd,o=e.summary,i=e.handleNewGame,c=e.draw,s=e.isOpen,l=e.onOpen,u=e.onClose,b=Object(r.useState)(!0),h=Object(a.a)(b,2),f=h[0],g=h[1];Object(r.useEffect)((function(){t&&(l(),setTimeout((function(){g(!1)}),3e3))}),[t]);var O={animalPoints:"Animal Tiles",dragonPoints:"Dragon Set",flowerPoints:"Seat Flower",tableWindPoints:"Prevailing Wind Set",yourWindPoints:"Seat Wind Set",totalPoints:"Total tai",allPong:"All Pong","\u81ed\u5e73\u548c":"All Chow","\u5e73\u548c":"Ping Wu","\u6e05\u4e00\u8272":"Full Color","\u6df7\u4e00\u8272":"Half Color",oneNine:"All Terminals",halfOneNine:"Terminals and Honors","\u4e03\u5bf9\u5b50":"7 Pairs","\u5341\u4e09\u5e7a":"13 Wonders"};if(t){if(c)return Object(y.jsxs)(W.a,{isOpen:s,onClose:u,children:[Object(y.jsx)(W.g,{}),Object(y.jsxs)(W.d,{children:[Object(y.jsx)(W.f,{children:"Draw"}),Object(y.jsx)(W.c,{}),Object(y.jsx)(W.e,{children:Object(y.jsx)(j.a,{isDisabled:f,onClick:i,children:"New game"})})]})]});var p=[];console.log("Summary:",o),o=Object.keys(o).forEach((function(e){o[e]>0&&(p=p.concat({name:O[e],points:o[e]}))}));var x=p.map((function(e){return Object(y.jsxs)(A.f,{children:[Object(y.jsx)(A.c,{children:e.name}),Object(y.jsx)(A.c,{isNumeric:!0,children:e.points})]})}));return console.log("Summary filtered",p),Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(W.a,{isOpen:s,onClose:u,children:[Object(y.jsx)(W.g,{}),Object(y.jsxs)(W.d,{children:[Object(y.jsx)(W.f,{h:"10px",children:Object(y.jsxs)(d.b,{children:[n.username," wins!"]})}),Object(y.jsx)(W.c,{}),Object(y.jsx)(W.b,{children:Object(y.jsxs)(A.a,{variant:"striped",size:"sm",children:[Object(y.jsx)(A.e,{children:Object(y.jsxs)(A.f,{children:[Object(y.jsx)(A.d,{children:"Name"}),Object(y.jsx)(A.d,{isNumeric:!0,children:"Double"})]})}),Object(y.jsx)(A.b,{children:x})]})}),Object(y.jsx)(W.e,{children:Object(y.jsx)(j.a,{size:"sm",isDisabled:f,onClick:i,children:"New game"})})]})]})})}return null}var M=t(78),F=t(76);function H(e){var n=e.name,t=e.score,r=e.info,o=e.pictures,i=Object(u.e)(),c=i.isOpen,a=i.onToggle,s=o.map((function(e){return""===e?Object(y.jsx)(d.a,{w:"10px"}):Object(y.jsx)(S.a,{src:"https://raw.githubusercontent.com/JovenSoh/sgmahjong/gh-pages/images/".concat(e,".jpg"),fallbackSrc:"",h:"26px",borderRadius:"5px",borderWidth:"1px",borderColor:"#343434",borderStyle:"solid",boxShadow:"1.2px 2px #000000"})}));return Object(y.jsxs)(d.a,{children:[Object(y.jsxs)(d.c,{children:[Object(y.jsx)(d.a,{_hover:{"text-decoration":"underline"},onClick:a,children:n}),Object(y.jsx)(d.f,{}),t]}),Object(y.jsxs)(b.a,{in:c,children:[r.split(".").map((function(e){return Object(y.jsx)(d.g,{align:"left",justifyContent:!0,fontSize:12,children:e})})),Object(y.jsx)(d.d,{spacing:"0px",children:s})]})]})}function z(e){var n,t=e.tableWind,r=e.yourWind,o=e.playerID,i=e.currentPlayer,c=e.gameState,a=e.handleNewGame,s=e.roundEnd,l=e.onOpen,b=e.addBot,f=e.connectionStatus,g=Object(u.c)(window.location.href),O=g.hasCopied,p=g.onCopy,x={"~east":"}wind1","~south":"}wind2","~west":"}wind3","~north":"}wind4"},m=x[t],v=c.map((function(e){return Object(y.jsxs)(d.c,{w:"100%",children:[e.username,Object(y.jsx)(d.f,{}),e.score]})})),w={"~east":1,"~south":2,"~west":3,"~north":4},P=[{name:"Prevailing wind set",score:1,info:"Pong or kong of prevailing wind",pictures:m?[m,m,m]:["}wind1","}wind1","}wind1"]},{name:"Seat wind set",score:1,info:"Pong or kong of seat wind",pictures:m?[m,m,m]:["}wind1","}wind1","}wind1"]},{name:"Dragon tiles set",score:1,info:"Pong or kong of any dragon tiles",pictures:["~red","~red","~red"]},{name:"All Chow",score:1,info:"Four sets of sequentials with an eye. Eye must not be prevailing or seat wind or dragon tile. Unless self-drawn, must have a two-sided wait",pictures:["bamboo1","bamboo2","bamboo3","circles1","circles2","circles3","numbers5","numbers5"]},{name:"Seat flower",score:1,info:"Flower corresponding to your seat position",pictures:r?["flowers"+w[r],"flowers"+(w[r]+4)]:["flowers1","flowers5"]},{name:"Animal tile",score:1,info:"Any animal tile",pictures:["cat","mouse","rooster","centipede"]},{name:"All Pong",score:2,info:"Four sets of pong or kong with an eye",pictures:["bamboo2","bamboo2","bamboo2","numbers6","numbers6","numbers6","~white","~white"]},{name:"Mixed suit",score:2,info:"Mahjong with one suit and honors",pictures:["~east","~east","~east","bamboo9","bamboo9","bamboo9","~red","~red"]},{name:"Terminals and Honors",score:2,info:"Mahjong with 1s, 9s, and honors",pictures:["circles1","circles1","circles1","numbers9","numbers9","numbers9","~north","~north"]},{name:"7 Pairs",score:3,info:"7 eyes",pictures:["~east","~east","~west","~west","~green","~green","circles5","circles5"]},{name:"Ping Wu",score:4,info:"All chow without flower or animal tiles",pictures:["bamboo4","bamboo5","bamboo6","circles4","circles5","circles6","numbers7","numbers7"]},{name:"Full Color",score:4,info:"Mahjong with only one suit",pictures:["numbers1","numbers2","numbers3","numbers8","numbers8","numbers8","numbers9","numbers9"]},{name:"13 Wonders",score:5,info:"Each terminal and honors. Any eye",pictures:["bamboo1","bamboo9","~east","~south","~west","~north","~red","~red"]},{name:"All Terminals",score:5,info:"Mahjong with only 1s and 9s",pictures:["numbers1","numbers1","numbers1","circles1","circles1","circles1","bamboo9","bamboo9"]}].map((function(e){return Object(y.jsx)(H,{name:e.name,score:e.score,info:e.info,pictures:e.pictures})})),C=[{name:"Predator Prey",score:1,info:"Cat-mouse rooster-centipede pair",pictures:["cat","mouse","","rooster","centipede"]},{name:"Flower Pair",score:1,info:"Own an opponent flower pair",pictures:["flowers"+(w[r]+1)%8,"flowers"+(w[r]+5)%8]},{name:"Flower Pair (Seat)",score:1,info:"Own your seat flower pair",pictures:["flowers"+w[r],"flowers"+w[r]]},{name:"Concealed Kong",score:2,info:"Perform a one/three tiles concealed kong",pictures:["bamboo8","bamboo8","bamboo8","bamboo8"]},{name:"Flowers Set (u/c)",score:4,info:"Own all red or black flowers",pictures:["flowers1","flowers2","flowers3","flowers4","flowers5","flowers6","flowers7","flowers8"]},{name:"Animals Set (u/c)",score:4,info:"Own all animal tiles",pictures:["cat","mouse","rooster","centipede"]}].map((function(e){return Object(y.jsx)(H,{name:e.name,score:e.score,info:e.info,pictures:e.pictures})}));return c.find((function(e){return e.playerID===o}))&&(n=c.find((function(e){return e.playerID===o})).username,console.log("USERNAME: ",n)),Object(y.jsx)(d.a,{w:"200px",h:"100vh",bg:"RGBA(255,255,255,0.9)",children:Object(y.jsxs)(M.e,{mr:"10px",align:"center",variant:"enclosed",isFitted:!0,children:[Object(y.jsxs)(M.b,{children:[Object(y.jsx)(M.a,{children:"Table"}),Object(y.jsx)(M.a,{children:"Scoring"})]}),Object(y.jsxs)(M.d,{children:[Object(y.jsx)(M.c,{w:"200px",children:Object(y.jsxs)(d.h,{spacing:"25px",children:[Object(y.jsxs)(d.a,{mt:"5px",children:[Object(y.jsx)(T,{playerID:o,username:n,currentPlayer:i,wind:r}),Object(y.jsxs)(d.c,{w:"190px",children:["Prevailing Wind ",Object(y.jsx)(d.f,{})," ",Object(y.jsx)(S.a,{src:"https://raw.githubusercontent.com/JovenSoh/sgmahjong/gh-pages/images/".concat(m,".jpg"),fallbackSrc:"/images/".concat(m,".jpg"),h:"30px",borderRadius:"5px"})," "]})]}),Object(y.jsxs)(d.a,{children:[Object(y.jsx)(d.e,{fontSize:20,mb:"5px",children:"Leaderboard"}),Object(y.jsx)(d.a,{w:"190px",children:v}),Object(y.jsx)(j.a,{isDisabled:c.length>=4,onClick:b,size:"sm",variant:"outline",children:" Add bot"})]}),Object(y.jsx)(d.c,{children:Object(y.jsxs)(j.b,{isAttached:!0,size:"sm",variant:"outline",children:[Object(y.jsx)(j.a,{disabled:!s,onClick:l,children:"Summary"}),Object(y.jsx)(j.a,{disabled:!s,onClick:a,children:"New game"})]})}),Object(y.jsxs)(d.a,{children:[Object(y.jsx)(d.g,{textAlign:"left",p:"0px",m:"0px",children:"Invite link"}),Object(y.jsxs)(F.b,{children:[Object(y.jsx)(F.a,{h:"30px",px:"2px",variant:"filled",value:O?"Copied!":window.location.href,isReadOnly:!0}),Object(y.jsx)(F.c,{h:"30px",children:Object(y.jsxs)(j.a,{h:"30px",onClick:p,variant:"outline",children:[" ",O?Object(y.jsx)(h.a,{h:"20px"}):Object(y.jsx)(h.c,{h:"20px"})," "]})})]})]}),Object(y.jsx)(d.f,{m:"auto"}),Object(y.jsxs)("p",{children:["Connection Status: ",f]})]})}),Object(y.jsxs)(M.c,{w:"200px",children:[Object(y.jsxs)(d.c,{w:"100%",children:[Object(y.jsx)("strong",{children:"Name"}),Object(y.jsx)(d.f,{}),Object(y.jsx)("strong",{children:"Double"})]}),P,Object(y.jsxs)(d.c,{w:"100%",mt:"10px",children:[Object(y.jsx)("strong",{children:"Instant Payout"}),Object(y.jsx)(d.f,{}),Object(y.jsx)("strong",{children:"Points"})]}),C]})]})]})})}var G=t(49);function L(e){var n=e.sendMessage,t=Object(u.e)({defaultIsOpen:!0}),o=t.isOpen,i=(t.onOpen,t.onClose),c=Object(r.useState)(""),s=Object(a.a)(c,2),l=s[0],b=s[1],h=function(){i(),n("Username: "+l)};return Object(y.jsxs)(W.a,{isOpen:o,onClose:i,closeOnOverlayClick:!1,children:[Object(y.jsx)(W.g,{}),Object(y.jsxs)(W.d,{children:[Object(y.jsx)(W.f,{children:"Username"}),Object(y.jsxs)(G.a,{px:"20px",children:[Object(y.jsx)(F.a,{onKeyPress:function(e){"Enter"===e.key?h():console.log()},onChange:function(e){b(e.target.value)},value:l,placeholder:"John Tan..."}),Object(y.jsxs)(d.c,{children:[Object(y.jsx)(d.f,{}),Object(y.jsx)(j.a,{my:"10px",onClick:h,type:"submit",children:"Submit"})]})]})]})]})}function B(){var e,n,t,o,i,g=Object(f.g)().gameId,O=Object(r.useState)("wss://mahjong.irscybersec.ml/api/".concat(g)),p=Object(a.a)(O,2),v=p[0],S=(p[1],Object(r.useState)([])),P=Object(a.a)(S,2),C=(P[0],P[1]),T=Object(r.useState)([]),I=Object(a.a)(T,2),k=(I[0],I[1]),N=Object(r.useState)([]),D=Object(a.a)(N,2),E=D[0],A=D[1],W=Object(r.useState)(),M=Object(a.a)(W,2),F=M[0],H=M[1],G=Object(r.useState)(),B=Object(a.a)(G,2),K=B[0],U=B[1],_=Object(r.useState)(null),q=Object(a.a)(_,2),Y=q[0],V=q[1],X=Object(r.useState)([]),Q=Object(a.a)(X,2),Z=Q[0],$=Q[1],ee=Object(r.useState)(),ne=Object(a.a)(ee,2),te=ne[0],re=ne[1],oe=Object(r.useState)([]),ie=Object(a.a)(oe,2),ce=ie[0],ae=ie[1],se=Object(r.useState)([]),le=Object(a.a)(se,2),ue=le[0],de=le[1],be=Object(r.useState)(""),je=Object(a.a)(be,2),he=je[0],fe=je[1],ge=Object(r.useState)(""),Oe=Object(a.a)(ge,2),pe=Oe[0],xe=Oe[1],me=Object(r.useState)([]),ve=Object(a.a)(me,2),we=ve[0],Se=ve[1],ye=Object(r.useState)(),Pe=Object(a.a)(ye,2),Ce=Pe[0],Te=Pe[1],Ie=Object(r.useState)(!1),ke=Object(a.a)(Ie,2),Ne=ke[0],De=ke[1],Ee=Object(r.useState)([]),Re=Object(a.a)(Ee,2),Ae=Re[0],We=Re[1],Je=Object(r.useState)([]),Me=Object(a.a)(Je,2),Fe=Me[0],He=Me[1],ze=Object(r.useState)([]),Ge=Object(a.a)(ze,2),Le=Ge[0],Be=Ge[1],Ke=Object(r.useState)(!1),Ue=Object(a.a)(Ke,2),_e=Ue[0],qe=Ue[1],Ye=Object(r.useState)(),Ve=Object(a.a)(Ye,2),Xe=Ve[0],Qe=Ve[1],Ze=Object(r.useState)(!1),$e=Object(a.a)(Ze,2),en=$e[0],nn=$e[1],tn=Object(u.e)(),rn=tn.isOpen,on=tn.onOpen,cn=tn.onClose,an=Object(u.e)(),sn=an.isOpen,ln=an.onClose,un=an.onToggle,dn=Object(r.useState)(!1),bn=Object(a.a)(dn,2),jn=bn[0],hn=bn[1],fn=Object(r.useState)(!1),gn=Object(a.a)(fn,2),On=gn[0],pn=gn[1],xn=Object(r.useState)(1),mn=Object(a.a)(xn,2),vn=mn[0],wn=(mn[1],Object(r.useState)(3e3)),Sn=Object(a.a)(wn,2),yn=(Sn[0],Sn[1],Object(r.useState)([])),Pn=Object(a.a)(yn,2),Cn=Pn[0],Tn=Pn[1],In=Object(r.useState)(null),kn=Object(a.a)(In,2),Nn=kn[0],Dn=kn[1],En=Z.reduce((function(e,n){return e["".concat(n.suit," ").concat(n.value)]=++e["".concat(n.suit," ").concat(n.value)]||0,e}),{}),Rn=function(){Wn("New game!")},An=l()(v),Wn=An.sendMessage,Jn=An.lastMessage,Mn=An.readyState,Fn=(e={},Object(c.a)(e,s.ReadyState.CONNECTING,"Connecting"),Object(c.a)(e,s.ReadyState.OPEN,"Connected"),Object(c.a)(e,s.ReadyState.CLOSING,"Closing"),Object(c.a)(e,s.ReadyState.CLOSED,"Disconnected"),Object(c.a)(e,s.ReadyState.UNINSTANTIATED,"Uninstantiated"),e)[Mn];return Object(r.useEffect)((function(){if(null!==Jn)if(C((function(e){return e.concat(Jn)})),console.log("Last message:",Jn.data),Jn.data.includes("Online users:")){var e=Jn.data.replace("Online users: ","");k(e)}else if(Jn.data.includes("Game state")){var r=Jn.data.replace("Game state: ","");Tn(JSON.parse(r))}else if(Jn.data.includes("Your ID")){var c=Jn.data.replace("Your ID: ","");A(c)}else if(Jn.data.includes("Tiles")){var s=JSON.parse(Jn.data.replace("Tiles: ",""));if(13===s.length?$(s.sort(x)):$((function(e){return e.concat(s).sort(x)})),re(s),console.log("New tiles:",s),13!==s.length){console.log("Tiles:",Z);var l=w(Z,ue,ce,pe,he,[],s),u=Object(a.a)(l,2),d=u[0],b=u[1];De(d),function(e){var n=Z.filter((function(n){return n.suit===e.suit&&n.value===e.value})).concat(e),t=Z.filter((function(e){return 3==En["".concat(e.suit," ").concat(e.value)]}));4==n.length?(Be([n.concat("four")]),console.log("Four concealed kong",n)):t&&(Be([t.concat("four")]),console.log("kongSets",t));var r=Cn.findIndex((function(e){return e.playerID===E})),o=Cn[r].revealedTiles.filter((function(n){return n.suit===e.suit&&n.value===e.value})).concat(e);4==o.length&&(Be([o.concat("one")]),console.log("One concealed kong",o))}(s),qe(d),Qe(b)}}else if(Jn.data.includes("Bonus")){var j=JSON.parse(Jn.data.replace("Bonus: ",""));2===(O=j).filter((function(e){return"cat"===e.suit||"mouse"===e.suit})).length?(console.log("CAT MOUSE PAIR"),Wn("AnimalPair")):2===O.filter((function(e){return"rooster"===e.suit||"centipede"===e.suit})).length&&(console.log("ROOSTER CENTIPEDE PAIR"),Wn("AnimalPair")),2===O.filter((function(e){return 1===e.value})).length?(console.log("FlowerPair 1"),Wn("FlowerPair ~east")):2===O.filter((function(e){return 2===e.value})).length?(console.log("2 FLOWER PAIR"),Wn("FlowerPair ~south")):2===O.filter((function(e){return 3===e.value})).length?(console.log("3 FLOWER PAIR"),Wn("FlowerPair ~west")):2===O.filter((function(e){return 4===e.value})).length&&(console.log("4 FLOWER PAIR"),Wn("FlowerPair ~north")),O.forEach((function(e){"mouse"===e.suit&&ce.filter((function(e){return"cat"===e.suit})).length>0||"cat"===e.suit&&ce.filter((function(e){return"mouse"===e.suit})).length>0?(console.log("CAT MOUSE PAIR"),Wn("AnimalPair")):("rooster"===e.suit&&ce.filter((function(e){return"centipede"===e.suit})).length>0||"centipede"===e.suit&&ce.filter((function(e){return"rooster"===e.suit})).length>0)&&(console.log("ROOSTER CENTIPEDE PAIR"),Wn("AnimalPair")),1===ce.filter((function(n){return n.value===e.value})).length&&console.log("".concat(e.value," FLOWER PAIR"))})),ae((function(e){return e.concat(j)}))}else if(Jn.data.includes("Table wind"))xe(Jn.data.replace("Table wind: ",""));else if(Jn.data.includes("Your wind"))fe(Jn.data.replace("Your wind: ",""));else if(Jn.data.includes("It is your turn"))nn(!0);else if(Jn.data.includes("Discards")){var h=JSON.parse(Jn.data.replace("Discards: ",""));h.length>we.length?(Te(h.at(-1)),function(e){if(i=!1,e&&E!==Y){var r=w(Z,ue,ce,pe,he,e,[]),c=Object(a.a)(r,2),s=c[0],l=c[1];Qe(l),console.log("Summary: ",l),s&&l.totalPoints>=vn&&(De(!0),i=!0,qe(s));var u=Z.filter((function(n){return n.suit===e.suit&&n.value===e.value})).concat(e);if(console.log("Same tiles: ",u),3==u.length?(De(!0),i=!0,He([u])):4==u.length&&(De(!0),i=!0,Be([u.concat("three")])),Cn.at(Cn.findIndex((function(e){return e.playerID===E}))-1).playerID===Y){n=Z.filter((function(n){return n.suit===e.suit&&(n.value===e.value-1||n.value===e.value-2)})),t=Z.filter((function(n){return n.suit===e.suit&&(n.value===e.value-1||n.value===e.value+1)})),o=Z.filter((function(n){return n.suit===e.suit&&(n.value===e.value+1||n.value===e.value+2)})),n=m(n),t=m(t),o=m(o);var d=[n,t,o].filter((function(e){return 2===e.length}));d.length>0&&(De(!0),i=!0,We(d))}}i&&Wn(E+" validMove")}(h.at(-1)),console.log("Last discarded",h.at(-1))):Te(),Se(h)}else if(Jn.data.includes("Previous player: "))V(Jn.data.replace("Previous player: ",""));else if(Jn.data.includes("Pong!"))Wn("Ping!");else if(Jn.data.includes("Revealed"))!function(){var e=JSON.parse(Jn.data.replace("Revealed: ","")),n=Z;console.log("New Tiles: ",n);for(var t=function(t){console.log("Target: ",e[t]),console.log("Target Index: ",n.indexOf(e[t])),n=n.filter((function(n){return!(n.suit===e[t].suit&&n.value===e[t].value&&n.id===e[t].id)}))},r=0;r<e.length;r++)t(r);$(n),de((function(n){return n.concat(e).sort(x)}))}();else if(Jn.data.includes("Current player: ")){var f=Jn.data.replace("Current player: ","");U(f.substring(1,f.length-1))}else if(Jn.data.includes("New game!"))pn(!1),hn(!1),Se([]),Te(),ae([]),de([]),Dn();else if(Jn.data.includes("wins")){Wn("ShowAll: "+JSON.stringify(Z)),$([]),pn(!0);var g=JSON.parse(Jn.data.split(" ")[2]);Qe(g),H(Jn.data.split(" ")[0])}else Jn.data.includes("Draw:")&&(hn(!0),pn(!0),Wn("ShowAll: "+JSON.stringify(Z)),$([]));var O}),[Jn,C]),Object(y.jsxs)(d.a,{h:"100vh",w:"100vw",bg:"#E3DBB3",children:[Object(y.jsx)(L,{sendMessage:Wn}),Object(y.jsx)(d.c,{zIndex:1,w:"100%",m:"auto",position:"absolute",children:Object(y.jsx)(R,{clientID:E,tiles:Z,newTile:te,handleSelectTile:function(e){console.log(e),Dn(e)},currentTurn:en,currentPlayer:K,gameState:Cn,discards:we,selectedTile:Nn,handleDiscard:function(){if(!On){qe(!1),Ne&&(De(!1),Wn(E+" skip")),console.log("Discarding ",Nn),Wn("Discard: "+JSON.stringify(Nn));var e=Z.filter((function(e){return!(e.suit===Nn.suit&&e.value===Nn.value&&e.id===Nn.id)}));$(e),Dn(null),Be([]),nn(!1)}},lastDiscard:Ce,pongTiles:Fe,handlePong:function(e){console.log("PONG!",Fe),De(!1),He([]),Wn(E+" pong "+JSON.stringify(e))},handleChow:function(e){console.log("CHOW!",Ae),De(!1),We([]),Wn(E+" chow "+JSON.stringify(e))},sequentialTiles:Ae,kongTiles:Le,handleKong:function(e,n){console.log("KONG!",e,n),De(!1),Be([]),"three"===n?Wn(E+" threekong "+JSON.stringify(e)):"four"===n?Wn(E+" fourkong "+JSON.stringify(e)):"one"===n&&Wn(E+" onekong "+JSON.stringify([e[0]]))},game:_e,handleGame:function(){Wn(E+" WINS! "+JSON.stringify(Xe)+" "+JSON.stringify(Z)),De(!1),qe(!1),$([])},validMove:Ne,handleSkip:function(){console.log("SKIP!"),Wn(E+" skip"),De(!1),qe(!1),He([]),Be([]),We([])}})}),Object(y.jsx)(d.c,{zIndex:2,float:"right",position:"relative",children:Object(y.jsx)(b.a,{in:!sn,onClose:ln,placement:"right",children:Object(y.jsx)(z,{tableWind:pe,yourWind:he,playerID:E,currentPlayer:K,gameState:Cn,handleNewGame:Rn,roundEnd:On,onOpen:on,addBot:function(){Wn("addBot")},connectionStatus:Fn})})}),Object(y.jsx)(d.c,{zIndex:2,float:"right",position:"relative",children:Object(y.jsxs)(j.a,{variant:"link",_focus:!1,onClick:un,alignItems:"top",mt:"3vh",h:"50px",children:[" ",sn?Object(y.jsx)(h.d,{boxSize:6}):Object(y.jsx)(h.b,{boxSize:4})," "]})}),Object(y.jsx)(J,{username:Cn.find((function(e){return e.playerID===F})),roundEnd:On,summary:Xe,handleNewGame:Rn,draw:jn,isOpen:rn,onOpen:on,onClose:cn})]})}var K=t.p+"static/media/mahjongVid.74b8b9da.webm";t(127);function U(){var e=Object(f.f)(),n=Object(r.useState)(""),t=Object(a.a)(n,2),o=t[0],i=t[1],c=Object(r.useState)("100%"),s=Object(a.a)(c,2),l=s[0],h=s[1],g=Object(u.e)(),O=g.isOpen,p=g.onToggle;return Object(y.jsxs)(d.b,{h:"100vh",w:"100vw",bg:"rgba(90,90,90,0.3)",children:[Object(y.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,id:"video",children:Object(y.jsx)("source",{src:K,type:"video/webm"})}),Object(y.jsxs)(d.a,{w:"300px",p:"10px",bgColor:"rgba(240,240,240,0.9)",borderRadius:"10px",children:[Object(y.jsx)(d.b,{children:Object(y.jsxs)(d.g,{fontSize:"24px",textAlign:"center",children:["Play ",Object(y.jsx)("strong",{children:"Singapore Mahjong"})," with your friends"]})}),Object(y.jsx)(j.a,{onClick:function(){e("/game/".concat(function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()}()))},w:"100%",variant:"outline",borderWidth:"1px",borderStyle:"solid",borderColor:"green",borderRadius:"10px",children:"Create game"}),Object(y.jsxs)(d.c,{children:[Object(y.jsx)(b.a,{mt:"7px",in:O,direction:"left",animateOpacity:!0,children:Object(y.jsx)(F.a,{px:"2px",focusBorderColor:"green",variant:"flushed",placeholder:"Invite code",value:o,onChange:function(e){return function(e){i(e.target.value)}(e)}})}),Object(y.jsxs)(j.a,{onClick:O?function(){o.length<10?alert("No room found"):e("/game/".concat(o))}:function(){h("35%"),p()},w:l,variant:"outline",_focus:{outline:"none"},borderWidth:"1px",borderStyle:"solid",borderColor:"green",borderRadius:"10px",children:[O?"Join":"Join game"," "]})]})]})]})}var _=t(50);function q(){return Object(y.jsx)(_.a,{forceRefresh:!0,basename:"/sgmahjong/",children:Object(y.jsxs)(f.c,{children:[Object(y.jsx)(f.a,{path:"/",exact:!0,element:Object(y.jsx)(U,{})}),Object(y.jsx)(f.a,{path:"/game/:gameId",exact:!0,element:Object(y.jsx)(B,{})})]})})}var Y=t(14);i.a.render(Object(y.jsx)(Y.a,{children:Object(y.jsx)(q,{})}),document.getElementById("root"))}},[[128,1,2]]]);
//# sourceMappingURL=main.a156a870.chunk.js.map